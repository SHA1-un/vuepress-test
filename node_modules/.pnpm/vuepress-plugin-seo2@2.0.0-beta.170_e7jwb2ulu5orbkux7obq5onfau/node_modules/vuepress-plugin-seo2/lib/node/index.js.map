{"version":3,"file":"index.js","sources":["../../src/node/utils.ts","../../src/node/compact/utils.ts","../../src/node/compact/convert.ts","../../src/node/info.ts","../../src/node/inject.ts","../../src/node/seo.ts","../../src/node/description.ts","../../src/node/plugin.ts"],"sourcesContent":["import {\n  isLinkHttp,\n  isString,\n  removeEndingSlash,\n  removeLeadingSlash,\n} from \"@vuepress/shared\";\nimport { Logger, isAbsoluteUrl, isUrl } from \"vuepress-shared/node\";\n\nimport type { App, Page } from \"@vuepress/core\";\nimport type { SeoOptions } from \"./options.js\";\nimport type { ExtendPage } from \"./typings/index.js\";\n\nexport const logger = new Logger(\"vuepress-plugin-seo2\");\n\nexport interface AlternateInfo {\n  path: string;\n  lang: string;\n}\n\nexport const getAlternateInfo = (\n  { lang, path, pathLocale }: Page,\n  { pages, siteData }: App\n): AlternateInfo[] =>\n  Object.entries(siteData.locales)\n    .map(([localePath, { lang }]) => ({\n      path: `${localePath}${path.replace(pathLocale, \"\")}`,\n      lang,\n    }))\n    .filter(\n      (item): item is AlternateInfo =>\n        isString(item.lang) &&\n        item.lang !== lang &&\n        pages.some(({ path }) => path === item.path)\n    );\n\nexport const getCover = (\n  { frontmatter }: ExtendPage,\n  { options: { base } }: App,\n  { hostname }: SeoOptions\n): string | null => {\n  const { banner, cover } = frontmatter;\n\n  if (banner) {\n    if (isAbsoluteUrl(banner)) return resolveUrl(hostname, base, banner);\n\n    if (isUrl(banner)) return banner;\n  }\n\n  if (cover) {\n    if (isAbsoluteUrl(cover)) return resolveUrl(hostname, base, cover);\n\n    if (isUrl(cover)) return cover;\n  }\n\n  return null;\n};\n\nexport const getImages = (\n  { content }: ExtendPage,\n  { options: { base } }: App,\n  { hostname }: SeoOptions\n): string[] => {\n  const result = /!\\[.*?\\]\\((.*?)\\)/giu.exec(content);\n\n  if (result) {\n    return result\n      .map(([, link]) => {\n        if (isAbsoluteUrl(link)) return resolveUrl(hostname, base, link);\n\n        if (isUrl(link)) return link;\n\n        return null;\n      })\n      .filter((item): item is string => item !== null);\n  }\n\n  return [];\n};\n\nexport const resolveUrl = (\n  hostname: string,\n  base: string,\n  url: string\n): string =>\n  `${\n    isLinkHttp(hostname)\n      ? removeEndingSlash(hostname)\n      : `https://${removeEndingSlash(hostname)}`\n  }${base}${removeLeadingSlash(url)}`;\n","import { colors } from \"@vuepress/utils\";\nimport { logger } from \"../utils.js\";\n\nexport const droppedLogger = (\n  options: Record<string, unknown>,\n  droppedOption: string,\n  hint = \"\",\n  newOption = \"\"\n): void => {\n  if (droppedOption in options) {\n    logger.error(\n      `\"${colors.magenta(droppedOption)}\" is ${colors.red(\"removed\")}${\n        newOption\n          ? `, please use ${colors.magenta(newOption)} instead.`\n          : \" and no longer supported\"\n      }${hint ? `\\n${hint}` : \"\"}`\n    );\n\n    if (!newOption) delete options[droppedOption];\n  }\n};\n","import { droppedLogger } from \"./utils.js\";\nimport type { SeoOptions } from \"../options.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: SeoOptions & Record<string, unknown>\n): void => {\n  droppedLogger(options, \"seo\", \"\", \"ogp\");\n  droppedLogger(options, \"customMeta\", \"\", \"customHead\");\n};\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport {\n  isArray,\n  isFunction,\n  isString,\n  removeEndingSlash,\n} from \"@vuepress/shared\";\nimport { getAuthor, getDate } from \"vuepress-shared/node\";\n\nimport { getAlternateInfo, getCover, getImages, resolveUrl } from \"./utils.js\";\n\nimport type { App } from \"@vuepress/core\";\nimport type { SeoOptions } from \"./options.js\";\nimport type {\n  ArticleSchema,\n  BlogPostingSchema,\n  ExtendPage,\n  SeoContent,\n  WebPageSchema,\n} from \"./typings/index.js\";\n\nexport const getOGP = (\n  page: ExtendPage,\n  options: SeoOptions,\n  app: App\n): SeoContent => {\n  const {\n    isArticle = (page): boolean =>\n      Boolean(page.filePathRelative && !page.frontmatter[\"home\"]),\n    author: globalAuthor,\n  } = options;\n  const {\n    options: { base },\n    siteData,\n  } = app;\n  const {\n    frontmatter: {\n      author: pageAuthor,\n      time,\n      date = time,\n      tag,\n      tags = <string[]>tag,\n    },\n    data: { git = {} },\n  } = page;\n\n  const title =\n    siteData.locales[page.pathLocale]?.title ||\n    siteData.title ||\n    siteData.locales[\"/\"]?.title ||\n    \"\";\n  const author =\n    pageAuthor === false ? [] : getAuthor(pageAuthor || globalAuthor);\n  const modifiedTime = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null;\n  const articleTags = isArray(tags) ? tags : isString(tag) ? [tag] : [];\n  const articleTitle = page.title;\n  const cover = getCover(page, app, options);\n  const images = getImages(page, app, options);\n  const locales = getAlternateInfo(page, app);\n  const publishedTime = getDate(date)?.value?.toISOString();\n\n  const ogImage = cover || images[0] || options.fallBackImage || \"\";\n\n  const defaultOGP: SeoContent = {\n    \"og:url\": resolveUrl(options.hostname, base, page.path),\n    \"og:site_name\": title,\n    \"og:title\": articleTitle,\n    \"og:description\": page.frontmatter.description || \"\",\n    \"og:type\": isArticle(page) ? \"article\" : \"website\",\n    \"og:image\": ogImage,\n    \"og:locale\": page.lang,\n    \"og:locale:alternate\": locales.map(({ lang }) => lang),\n    ...(modifiedTime ? { \"og:updated_time\": modifiedTime } : {}),\n    ...(options.restrictions\n      ? { \"og:restrictions:age\": options.restrictions }\n      : {}),\n\n    ...(options.twitterID ? { \"twitter:creator\": options.twitterID } : {}),\n    ...(ogImage\n      ? {\n          \"twitter:card\": \"summary_large_image\",\n          \"twitter:image:alt\": articleTitle,\n        }\n      : {}),\n\n    \"article:author\": author[0]?.name,\n    \"article:tag\": articleTags,\n    ...(publishedTime ? { \"article:published_time\": publishedTime } : {}),\n    ...(modifiedTime ? { \"article:modified_time\": modifiedTime } : {}),\n  };\n\n  return defaultOGP;\n};\n\nexport const getJSONLD = (\n  page: ExtendPage,\n  options: SeoOptions,\n  app: App\n): ArticleSchema | BlogPostingSchema | WebPageSchema => {\n  const {\n    isArticle = (page): boolean =>\n      Boolean(page.filePathRelative && !page.frontmatter[\"home\"]),\n    author: globalAuthor,\n  } = options;\n\n  const {\n    title,\n    frontmatter: { author: pageAuthor, description, time, date = time },\n    data: { git = {} },\n  } = page;\n\n  const author =\n    pageAuthor === false ? [] : getAuthor(pageAuthor || globalAuthor);\n  const datePublished = getDate(date)?.value?.toISOString();\n  const dateModified = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null;\n  const cover = getCover(page, app, options);\n  const images = getImages(page, app, options);\n\n  return isArticle(page)\n    ? {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"Article\",\n        headline: title,\n        image: images.length ? images : [cover || options.fallBackImage || \"\"],\n        datePublished,\n        dateModified,\n        author: author.map((item) => ({ \"@type\": \"Person\", ...item })),\n      }\n    : {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"WebPage\",\n        name: title,\n        ...(description ? { description } : {}),\n      };\n};\n\nexport const getCanonicalLink = (\n  page: ExtendPage,\n  options: SeoOptions\n): string | null =>\n  isFunction(options.canonical)\n    ? options.canonical(page)\n    : isString(options.canonical)\n    ? `${removeEndingSlash(options.canonical)}${page.path}`\n    : null;\n\nexport const getAlternateLinks = (\n  page: ExtendPage,\n  { hostname }: SeoOptions,\n  app: App\n): { lang: string; path: string }[] =>\n  getAlternateInfo(page, app).map(({ lang, path }) => ({\n    lang,\n    path: resolveUrl(hostname, app.options.base, path),\n  }));\n","import type { HeadConfig } from \"@vuepress/core\";\nimport type {\n  ArticleSchema,\n  ArticleSeoContent,\n  BlogPostingSchema,\n  SeoContent,\n  WebPageSchema,\n} from \"./typings/index.js\";\n\ninterface MetaOptions {\n  name: string;\n  content: string;\n  attribute?: string;\n}\n\nconst appendMetaToHead = (\n  head: HeadConfig[],\n  {\n    name,\n    content,\n    attribute = [\"article:\", \"og:\"].some((type) => name.startsWith(type))\n      ? \"property\"\n      : \"name\",\n  }: MetaOptions\n): void => {\n  if (content) head.push([\"meta\", { [attribute]: name, content }]);\n};\n\nexport const addOGP = (head: HeadConfig[], content: SeoContent): void => {\n  for (const property in content)\n    switch (property) {\n      case \"article:tag\":\n        (<ArticleSeoContent>content)[\"article:tag\"]!.forEach((tag: string) =>\n          appendMetaToHead(head, { name: \"article:tag\", content: tag })\n        );\n        break;\n      case \"og:locale:alternate\":\n        content[\"og:locale:alternate\"].forEach((locale: string) => {\n          if (locale !== content[\"og:locale\"])\n            appendMetaToHead(head, {\n              name: \"og:locale:alternate\",\n              content: locale,\n            });\n        });\n        break;\n      default:\n        if (<string>content[<keyof SeoContent>property])\n          appendMetaToHead(head, {\n            name: property,\n            content: <string>content[<keyof SeoContent>property],\n          });\n    }\n};\n\nexport const appendJSONLD = (\n  head: HeadConfig[],\n  content: ArticleSchema | BlogPostingSchema | WebPageSchema\n): void => {\n  head.push([\n    \"script\",\n    { type: \"application/ld+json\" },\n    JSON.stringify(content),\n  ]);\n};\n\nexport const appendCanonical = (\n  head: HeadConfig[],\n  url?: string | null\n): void => {\n  if (url) head.push([\"link\", { rel: \"canonical\", href: url }]);\n};\n\nexport const appendAlternate = (\n  head: HeadConfig[],\n  urls: { lang: string; path: string }[]\n): void => {\n  urls.forEach(({ lang, path }) => {\n    head.push([\n      \"link\",\n      { rel: \"alternate\", hreflang: lang.toLowerCase(), href: path },\n    ]);\n  });\n};\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { fs } from \"@vuepress/utils\";\nimport {\n  getAlternateLinks,\n  getCanonicalLink,\n  getJSONLD,\n  getOGP,\n} from \"./info.js\";\nimport {\n  addOGP,\n  appendAlternate,\n  appendCanonical,\n  appendJSONLD,\n} from \"./inject.js\";\nimport { logger } from \"./utils.js\";\n\nimport type { App, AppDir } from \"@vuepress/core\";\nimport type { SeoOptions } from \"./options.js\";\n\nexport const appendSEO = (app: App, options: SeoOptions): void => {\n  app.pages.forEach((page) => {\n    const head = page.frontmatter.head || [];\n\n    const defaultOGP = getOGP(page, options, app);\n    const defaultJSONLD = getJSONLD(page, options, app);\n\n    const ogpContent = options.ogp\n      ? options.ogp(defaultOGP, page, app)\n      : defaultOGP;\n\n    const jsonLDContent = options.jsonLd\n      ? options.jsonLd(defaultJSONLD, page, app)\n      : defaultJSONLD;\n\n    const canonicalLink = getCanonicalLink(page, options);\n    const alternateLinks = getAlternateLinks(page, options, app);\n\n    addOGP(head, ogpContent);\n    appendJSONLD(head, jsonLDContent);\n    appendCanonical(head, canonicalLink);\n    appendAlternate(head, alternateLinks);\n\n    if (options.customHead) options.customHead(head, page, app);\n\n    page.frontmatter.head = head;\n  });\n};\n\nexport const generateRobotsTxt = async (dir: AppDir): Promise<void> => {\n  logger.load(\"Generating robots.txt\");\n  const publicPath = dir.public(\"robots.txt\");\n\n  let content = fs.existsSync(publicPath)\n    ? await fs.readFile(publicPath, { encoding: \"utf8\" })\n    : \"\";\n\n  if (content && !content.includes(\"User-agent\")) {\n    logger.error();\n    logger.update(\"robots.txt seems invalid!\");\n  } else {\n    content += \"\\nUser-agent:*\\nDisallow:\\n\";\n\n    await fs.writeFile(dir.dest(\"robots.txt\"), content, {\n      flag: \"w\",\n    });\n\n    logger.succeed();\n  }\n};\n","import { getPageText, stripTags } from \"vuepress-shared/node\";\n\nimport type { ExtendPage } from \"./typings/index.js\";\n\nexport const generateDescription = (\n  page: ExtendPage,\n  autoDescription = true\n): void => {\n  // generate description\n  if (!page.frontmatter.description && autoDescription) {\n    if (page.data.excerpt)\n      page.frontmatter.description = stripTags(page.data.excerpt)\n        // convert link breaks into spaces\n        .replace(/(?:\\r?\\n)+/g, \" \")\n        // convert 2 or more spaces into 1\n        .replace(/ +/g, \" \")\n        .trim();\n    else {\n      const pageText = getPageText(page);\n\n      page.frontmatter.description =\n        pageText.length > 180 ? `${pageText.slice(0, 177)}...` : pageText;\n    }\n\n    page.data.autoDesc = true;\n  }\n};\n","import { colors } from \"@vuepress/utils\";\n\nimport { convertOptions } from \"./compact/index.js\";\nimport { appendSEO, generateRobotsTxt } from \"./seo.js\";\nimport { generateDescription } from \"./description.js\";\nimport { logger } from \"./utils.js\";\n\nimport type { Plugin, PluginFunction } from \"@vuepress/core\";\nimport type { SeoOptions } from \"./options.js\";\nimport type { ExtendPage } from \"./typings/index.js\";\n\nexport const seoPlugin =\n  (options: SeoOptions, legacy = true): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy) convertOptions(options as SeoOptions & Record<string, unknown>);\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    const plugin: Plugin = { name: \"vuepress-plugin-seo2\" };\n\n    if (!options.hostname) {\n      logger.error(`Option ${colors.magenta(\"hostname\")} is required!`);\n\n      return plugin;\n    }\n\n    return {\n      ...plugin,\n\n      extendsPage: (page: ExtendPage): void => {\n        generateDescription(page, options.autoDescription !== false);\n      },\n\n      onInitialized: (app): void => {\n        appendSEO(app, options);\n      },\n\n      onGenerated: (app): Promise<void> => generateRobotsTxt(app.dir),\n    };\n  };\n"],"names":["logger","Logger","getAlternateInfo","lang","path","pathLocale","pages","siteData","localePath","item","isString","getCover","frontmatter","base","hostname","banner","cover","isAbsoluteUrl","resolveUrl","isUrl","getImages","content","result","link","url","isLinkHttp","removeEndingSlash","removeLeadingSlash","droppedLogger","options","droppedOption","hint","newOption","colors","convertOptions","getOGP","page","app","_a","_b","_c","_d","_e","isArticle","globalAuthor","pageAuthor","time","date","tag","tags","git","title","author","getAuthor","modifiedTime","articleTags","isArray","articleTitle","images","locales","publishedTime","getDate","ogImage","getJSONLD","description","datePublished","dateModified","getCanonicalLink","isFunction","getAlternateLinks","appendMetaToHead","head","name","attribute","type","addOGP","property","locale","appendJSONLD","appendCanonical","appendAlternate","urls","appendSEO","defaultOGP","defaultJSONLD","ogpContent","jsonLDContent","canonicalLink","alternateLinks","generateRobotsTxt","dir","publicPath","fs","generateDescription","autoDescription","stripTags","pageText","getPageText","seoPlugin","legacy","plugin"],"mappings":"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"}